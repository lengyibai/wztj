import{l as R,r as h,w as U,B as K,M as H,u as l,C as g,D as S,H as L,a0 as j,O as y,o as q,j as Q,y as X,x as Y,Q as N,U as Z,P as J,F as ee,G as te,S as P,T as C,E as oe}from"./wzry-wzry_vue-ZP7q88Pe.js";import{s as V}from"./wzry-wzry_vuePlugin-8reJzXjy.js";import{aW as ae,s as se,aX as ne,q as B,aY as D,aP as le,ay as I,aZ as b,U as re,aG as A,o as ie,t as ce,n as ue,l as de,aO as F,w as z}from"./wzry-index-O-tmU9-f.js";import{F as fe,K as pe}from"./wzry-index-JMl6VVSm.js";import{S as ve}from"./wzry-index-XCxOg5OP.js";import{F as _e}from"./wzry-index-jh5mX5FK.js";/* empty css                                                                   */import"./wzry-wzry_axios-wVsZAsRs.js";import"./wzry-wzry_dayjs-p57Mk9r_.js";import"./wzry-wzry_lodash-4gQjN7DL.js";import"./wzry-wzry_i18n-x0daaVag.js";const he=(m={count:2,gap:10,children_list:[]})=>{const{count:i,gap:r,children_list:e}=m;if(!e[0])return;const s=e[0].offsetWidth,d=[];for(let t=0;t<e.length;t++)if(t<i)e[t].style.top=r+"px",d.push(e[t].offsetHeight+r),e[t].style.left=(s+r)*t+"px",e[t].style.opacity="1",e[t].style.transform="initial";else{const c={minHeight:d[0],minIndex:0};for(let u=0;u<d.length;u++)d[u]<c.minHeight&&(c.minHeight=d[u],c.minIndex=u);e[t].style.top=c.minHeight+r+"px",e[t].style.left=(s+r)*c.minIndex+"px",e[t].style.opacity="1",e[t].style.transform="initial",d[c.minIndex]=parseFloat(e[t].style.top)+e[t].offsetHeight}},me=R({__name:"index",props:{count:{default:2},gap:{default:15},scrollTop:{},finish:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["scroll","load-more"],setup(m,{expose:i,emit:r}){const e=m,s=r,d=h(),t=h(),c=h([]),u=()=>{if(!t.value)return;const n=Array.from(t.value.children);n&&(c.value=n,he({count:e.count,gap:e.gap,children_list:c.value}))},v=()=>{const n=(f,_)=>{const x=f.querySelectorAll("img");Array.from(x).forEach(T=>{T.addEventListener("load",_)})};u(),n(t.value,()=>{u()})},w=(n,f=!1)=>{var _;(_=d.value)==null||_.scroll({top:n,behavior:f?"smooth":"auto"})};return U(()=>e.count,u),K(()=>{v(),new ae({parent:t.value.parentElement,loadHeight:10},{load(){e.loading||e.finish||s("load-more")},scroll:n=>{s("scroll",n)}})}),i({_el:t,_watchImgLoad:v,_updateSizePosition:u,_setPosition:w}),(n,f)=>H((g(),S("div",{ref_key:"waterfallRef",ref:d,class:"waterfall"},[L("div",{ref_key:"waterfallContentRef",ref:t,class:"waterfall-content"},[j(n.$slots,"default",{},void 0,!0)],512),y(ne,{loading:n.loading,class:"load-more",finish:n.finish},null,8,["loading","finish"])])),[[l(se)]])}}),ge=B(me,[["__scopeId","data-v-83a8502e"]]),ye={class:"savor-toolbar"},Se={class:"filter-select"},we=R({__name:"index",emits:["change"],setup(m,{expose:i,emit:r}){const e=r,s=D(),{sort_type:d}=V(s),t=["正序","倒序"],c=h(""),u=()=>{c.value="",e("change")},v=f=>{s.sortType(t[f]),u()},w=f=>{s.filterGender(f),u()},n=()=>{s.searchAtlas(c.value),e("change")};return i({_clearName:u}),(f,_)=>(g(),S("div",ye,[L("div",Se,[y(l(le),{"sort-text":l(d),options:t,onSelect:v},null,8,["sort-text"])]),y(l(fe),{onChange:w}),y(l(ve),{modelValue:c.value,"onUpdate:modelValue":_[0]||(_[0]=x=>c.value=x),onChange:n},null,8,["modelValue"])]))}}),xe=B(we,[["__scopeId","data-v-58ba9ec5"]]),be=()=>{const m={count:h(2)},{count:i}=m,r=()=>{const s=window.innerWidth;s>=3e3?i.value=8:s>=2500?i.value=7:s>=2e3?i.value=6:s>=1500?i.value=5:s>=1e3?i.value=4:s>=500?i.value=3:s<500&&(i.value=2),b.emit("update-waterfall")};K(()=>{r()});const e=I(r,250);return window.addEventListener("resize",e),q(()=>{window.removeEventListener("resize",e)}),{...m}},ke={class:"savor"},Ie={class:"savor-main"},Le=["onMouseenter","onMouseup","onTouchstart"],Te={key:0,class:"hero-name"},$e={key:1,class:"skin-name"},Ce=["src"],He=R({name:"Savor",__name:"index",setup(m){const i=re(),r=D(),{show_list:e,scroll:s,finish:d,loading:t}=V(r),{playAudio:c}=de(),{count:u}=be(),v=h(),w=h(),n=h(0),f=h(!1);r.getAtlasList();const _=Q(()=>(o,p)=>o==="HERO"&&!i.hero_list[p]?{text:A("a20t",{v:"英雄"}),disabled:!0}:o==="SKIN"&&!i.skin_list.includes(p)?{text:A("a20t",{v:"皮肤"}),disabled:!0}:{text:ie.o12u,disabled:!1}),x=(o,p)=>{n.value=o,new Image().src=p},T=(o,p,a)=>{if(p==="HERO"){if(!F(a))return;z({id:a,parent:o.target,type:"SKIN"})}else{if(!F(a,"SKIN"))return;z({id:a,parent:o.target,type:"SKIN"})}},M=I(()=>{var o;(o=v.value)==null||o._watchImgLoad()},500),O=()=>{r.loadMore(),M()},$=I(o=>{r.setScroll(o),f.value=o>250},250),W=()=>{var o;(o=v.value)==null||o._setPosition(0,!0)},G=()=>{var o;$(0),(o=w.value)==null||o._clearName()},E=I(()=>{var o;(o=v.value)==null||o._updateSizePosition()},500);return X(()=>{var o;c("gz76"),E(),(o=v.value)==null||o._setPosition(s.value),b.on("update-waterfall",E),b.on("watch-waterfall",M)}),Y(()=>{b.off("update-waterfall"),b.off("watch-waterfall")}),(o,p)=>(g(),S("div",ke,[L("div",Ie,[y(Z,{name:"to-bottom",appear:""},{default:N(()=>[y(xe,{ref_key:"savorToolbarRef",ref:w,onChange:p[0]||(p[0]=a=>l($)(0))},null,512)]),_:1}),y(l(pe),{active:f.value,onBackTop:W},null,8,["active"]),l(e).length?(g(),J(l(ge),{key:0,ref_key:"waterfallRef",ref:v,count:l(u),loading:l(t),finish:l(d),"scroll-top":l(s),onLoadMore:O,onScroll:l($)},{default:N(()=>[(g(!0),S(ee,null,oe(l(e),a=>H((g(),S("div",{key:a.poster,class:te([{active:n.value===a.id},"atlas-card"]),onMouseenter:k=>x(a.id,a.posterBlur),onMouseup:k=>T(k,a.type,a.id),onTouchstart:k=>x(a.id,a.posterBlur),onMouseleave:p[1]||(p[1]=k=>n.value=0)},[a.type==="HERO"?(g(),S("div",Te,P(a.name),1)):C("",!0),a.type==="SKIN"?(g(),S("div",$e,P(a.name),1)):C("",!0),H(L("img",{class:"bg",src:a.coverBlur},null,8,Ce),[[l(ce),{img:a.cover}]])],42,Le)),[[l(ue),{disabled:_.value(a.type,a.id).disabled,text:_.value(a.type,a.id).text}]])),128))]),_:1},8,["count","loading","finish","scroll-top","onScroll"])):C("",!0)]),y(l(_e),{type:"atlas",onChange:G})]))}}),De=B(He,[["__scopeId","data-v-4347188c"]]);export{De as default};
