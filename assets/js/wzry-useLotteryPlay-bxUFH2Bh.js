import{bm as fe,b as A,bn as Re,bl as g,bo as te,bk as J,a9 as V,bp as se,p as z,bq as B,e as pe,br as ue,az as ke,F as w,G as de,y as oe,aa as U,ae as he,X as Se,ab as ne,o as q,C as W,bj as Ee,W as ee,I as Ne,Y as Le,A as Ie,$ as Ce,k as He}from"./wzry-index-CTpLHwAa.js";import{K as $e,a as xe}from"./wzry-index-BrrdO2Ct.js";import{K as ie}from"./wzry-index-B-RbYMYs.js";import{k as j,E as k,F as O,J as m,M as S,V as L,u as t,O as h,c as f,S as b,H as Ye,I as ge,G as ae,X as Q,P,Q as I,r as M,w as be,y as Ae,x as we,L as me,N as ce,T as G}from"./wzry-wzry_vue-BEC82j21.js";import{s as re}from"./wzry-wzry_vuePlugin-DfAOYnI4.js";const Pe={dq76:`1、优先使用{crystal}夺宝石进行夺宝。
2、{crystal}水晶在幸运值为[{luckValue1}-{luckValue2}]时获得，获取后将[重置]幸运值。
3、{type}夺宝石补给倒计时结束后，不会自动叠加，需要领取补给后再次设置模式，重新倒计时。
4、{type}夺宝石补给每日领取上限为[${fe}]个夺宝石，额外的{type}夺宝次数前往[商城-道具商店]购买。
5、{type}夺宝石补给如果在倒计时没有结束时[终止]，会根据当前已过去的时间，匹配对应的模式奖励。
6、{type}夺宝石补给倒计时是根据[当前时间-开始时间]来计算[剩余时间]，不受关闭浏览器影响。
※、{type}夺宝概率设计：{chance}放入奖池，从奖池随机选择，没有保底机制。`,g5k2:"",j5s5:"",ak79:"",yn25:"",tw50:"",fr16:"",pg06:"",op14:"",sg33:"",kc45:"",mx01:"",dy76:"",xw01:"",en46:"",ku28:"",vf96:"",ib49:"",hv47:""},_e=(o,e)=>{let s=Pe[o];return Object.entries(e).forEach(([n,i])=>{s=s.replaceAll(`{${n}}`,i.toString())}),s},Me={class:"lottery-toolbar"},De=["data-text"],Ke={class:"prop-num"},Ge=j({__name:"index",props:{type:{}},setup(o){const e=o,s=e.type==="HERO"?"英雄":"皮肤",n={HERO:"HERO_LOTTERY_COIN",SKIN:"SKIN_LOTTERY_COIN"},i={HERO:"HERO_LOTTERY_STONE",SKIN:"SKIN_LOTTERY_STONE"},c=()=>{let d="";for(const E in te){const l=Number(E),a=te[l],u=J.HERO.find(T=>T.id===l);d+=`[${a}个${V[u.type]}*${u.num||1}]、`}return d.slice(0,-1)},p=()=>{let d="";for(const E in se){const l=Number(E),a=se[l],u=J.SKIN.find(T=>T.id===l);d+=`[${a}个${V[u.type]}*${u.num||1}]、`}return d.slice(0,-1)},r=()=>{Re({title:`${e.type==="HERO"?"英雄":"皮肤"}夺宝说明`,content:e.type==="HERO"?_e("dq76",{crystal:"王者",type:"英雄",luckValue1:g.hero[0],luckValue2:g.hero[1],chance:c()}):_e("dq76",{crystal:"荣耀",type:"皮肤",luckValue1:g.skin[0],luckValue2:g.skin[1],chance:p()})})};return(d,E)=>(O(),k("div",Me,[m("div",{class:"title","data-text":t(s)+"夺宝"},L(t(s))+"夺宝",9,De),S(h(t($e),{"margin-left":"1rem",onClick:r},null,512),[[t(A)]]),m("div",Ke,[h(t(ie),{"prop-key":n[d.type],gap:"0.75rem",height:"3rem","font-size":"2.25rem","margin-right":"2rem"},null,8,["prop-key"]),h(t(ie),{"prop-key":i[d.type],gap:"0.75rem",height:"3rem","font-size":"2.25rem"},null,8,["prop-key"])])]))}}),ht=z(Ge,[["__scopeId","data-v-4824eab8"]]),Ve={class:"supply-mode"},Ue={class:"title"},ze={key:0,class:"mode-list"},Be=["data-text","onClick"],je={key:1,class:"ready-start"},Fe={class:"tip"},Xe={class:"prop"},qe=["src"],We={class:"btns"},Je={class:"supply-remain-num"},Qe={class:"value"},Ze=j({__name:"index",props:{type:{}},setup(o){const e=o,s=B(),{setTimeMode:n,startCountdown:i}=s,{hero_mode:c,skin_mode:p,skin_supply_status:r,hero_supply_status:d,hero_supply_remain_num:E,skin_supply_remain_num:l}=re(s),{playAudio:a}=pe(),u=e.type==="HERO"?c:p,T=e.type==="HERO"?d:r,$=e.type==="HERO"?"HERO_LOTTERY_STONE":"SKIN_LOTTERY_STONE",x=e.type==="HERO"?E:l,F=f(()=>({SELECT:"请选择补给模式",READY:"准备开始"})[T.value]),Y=C=>{n(e.type,C),a("v6p0")},N=()=>{a("pj83")};return(C,R)=>(O(),k("div",Ve,[m("div",Ue,L(F.value),1),t(T)==="SELECT"?(O(),k("div",ze,[(O(!0),k(Ye,null,ge(t(ke).LOTTERY_SUPPLY_MODE,(H,D)=>S((O(),k("div",{key:D,class:ae([t(ue)(H.seconds),"mode"]),"data-text":H.label,onClick:Z=>Y(D)},[Q(L(H.label),1)],10,Be)),[[t(A)]])),128))])):b("",!0),t(T)==="READY"&&t(u)?(O(),k("div",je,[m("div",{class:ae(["desc",t(ue)(t(u).seconds)])},L(t(u).label),3),m("div",Fe,[R[1]||(R[1]=m("div",{class:"text"},"倒计时结束后可领取",-1)),m("div",Xe,[m("img",{src:t(w)(t(de).ICON[t($)]),alt:"",class:"icon"},null,8,qe),m("span",null,"×"+L(t(u).count),1)])]),m("div",We,[S((O(),P(t(oe),{class:"k-button",type:"warning",onClick:R[0]||(R[0]=H=>(t(i)(C.type),N()))},{default:I(()=>R[2]||(R[2]=[Q(" 开始 ")])),_:1,__:[2]})),[[t(A)]])])])):b("",!0),m("div",Je,[R[3]||(R[3]=m("div",{class:"label"},"今日补给剩余额度：",-1)),m("div",Qe,L(t(x)),1)])]))}}),et=z(Ze,[["__scopeId","data-v-f317c82c"]]),tt=()=>{const o=[],e={left:[0,0],top:[0,0]},s=M(),n=M(0),i=f(()=>o[n.value]);for(const a in U)o.push(w(U[a]));const c=()=>{n.value++,n.value>=o.length&&(n.value=0)},p=(a,u)=>{s.value&&(c(),s.value.style[a]=`calc(100% - ${s.value.offsetWidth/16}rem)`,e[a][0]=setTimeout(()=>{s.value&&(c(),s.value.style[a]="0%",e[a][1]=setTimeout(()=>{p(a,u)},u))},u))},r=()=>p("left",7200),d=()=>p("top",4600);return{img:i,circularRef:s,startAnimate:()=>{s.value.style.left="0%",s.value.style.top="0%",setTimeout(()=>{r(),d()},10)},clearAnimate:()=>{[...e.left,...e.top].forEach(a=>{clearTimeout(a)})}}},st={class:"animate-move"},ot=["src"],nt=j({__name:"index",props:{type:{}},setup(o,{expose:e}){const s=o,n=B(),{circularRef:i,img:c,startAnimate:p,clearAnimate:r}=tt(),d=f(()=>s.type==="HERO"?n.hero_countdown:n.skin_countdown),E=f(()=>(s.type==="HERO"?n.hero_supply_status:n.skin_supply_status)==="RUNNING");return be(E,l=>{l?p():r()}),Ae(()=>{E.value&&p()}),we(r),e({_clearAnimate:r}),(l,a)=>(O(),k("div",st,[m("img",{src:t(c),class:"bg",alt:""},null,8,ot),S(m("div",{ref_key:"circularRef",ref:i,class:"circular",style:me({backgroundImage:`url(${t(c)})`})},null,4),[[ce,E.value]]),h(G,{name:"fade"},{default:I(()=>[E.value?(O(),P(t(xe),{key:0,class:"k-scroll-countdown",nums:d.value},null,8,["nums"])):b("",!0)]),_:1})]))}}),at=z(nt,[["__scopeId","data-v-68e51d55"]]),ct={class:"receive-prop"},rt={class:"title"},lt={class:"prop"},ut={class:"count"},it={class:"btns"},_t=j({__name:"index",props:{type:{}},setup(o){const e=o,s=B(),n=he(),{hero_mode:i,skin_mode:c}=re(s),p=e.type==="HERO"?i:c,r=e.type==="HERO"?"HERO_LOTTERY_STONE":"SKIN_LOTTERY_STONE",d=()=>{const l=p.value.count;ne({icon:w(U[r]),name:V[r],num:l,key:r}),r==="HERO_LOTTERY_STONE"?n.setTaskStatus("today_hero_supply",l):n.setTaskStatus("today_skin_supply",l),s.setSupplyRemainNum(e.type,l),s.setSupplyStatus(e.type,"IDLE")},E=()=>{d(),s.startCountdown(e.type)};return(l,a)=>{var u;return O(),k("div",ct,[m("div",rt,"本次时长："+L(t(Se)(t(p).seconds)),1),m("div",lt,[m("div",{class:"icon",style:me({backgroundImage:`url(${t(w)(t(de).ICON[t(r)])})`})},null,4),m("div",ut,"×"+L((u=t(p))==null?void 0:u.count),1)]),m("div",it,[S((O(),P(t(oe),{class:"k-button",type:"warning",onClick:d},{default:I(()=>a[0]||(a[0]=[Q("领取")])),_:1,__:[0]})),[[t(A)]]),S((O(),P(t(oe),{class:"k-button",type:"warning",onClick:E},{default:I(()=>a[1]||(a[1]=[Q(" 领取并继续 ")])),_:1,__:[1]})),[[t(A)]])])])}}}),pt=z(_t,[["__scopeId","data-v-9c86ef52"]]),dt={class:"supply-area"},Et={class:"text"},mt=j({__name:"index",props:{type:{}},setup(o){const e=o,s=B(),{playAudio:n}=pe(),i=M(),c=f(()=>e.type==="HERO"?s.hero_supply_status:s.skin_supply_status),p=()=>{if(c.value==="RUNNING"){q({text:W.jn63,confirm(){i.value._clearAnimate(),s.stopCountdown(e.type),n("pk92")}});return}if(c.value!=="IDLE"){s.setSupplyStatus(e.type,"IDLE"),n("pk92");return}n(),s.setSupplyStatus(e.type,"SELECT")};return(r,d)=>(O(),k("div",dt,[h(G,{name:"fade"},{default:I(()=>[c.value!=="RECEIVE"?S((O(),k("i",{key:0,class:ae(["iconfont",[{active:c.value!=="IDLE"},c.value==="RUNNING"?"wzry-tingzhi":"wzry-kaiguan"]]),onClick:p},null,2)),[[t(A)]]):b("",!0)]),_:1}),S(m("div",Et,"夺宝石补给站",512),[[ce,c.value==="IDLE"]]),h(G,{name:"fade"},{default:I(()=>[["SELECT","READY"].includes(c.value)?(O(),P(et,{key:0,type:r.type},null,8,["type"])):b("",!0)]),_:1}),h(G,{name:"fade"},{default:I(()=>[S(h(at,{ref_key:"animateMoveRef",ref:i,type:r.type},null,8,["type"]),[[ce,c.value!=="IDLE"]])]),_:1}),h(G,{name:"fade"},{default:I(()=>[c.value==="RECEIVE"?(O(),P(pt,{key:0,type:r.type},null,8,["type"])):b("",!0)]),_:1})]))}}),St=z(mt,[["__scopeId","data-v-cbc7a766"]]);function yt(o){const e=Ee(),s=o==="HERO"?te:se,n=o==="HERO"?"hero_lucky":"skin_lucky",i=o==="HERO"?g.hero:g.skin,c={gift_index:M(0),crystal_index:M(ee(i[0],i[1]))},{gift_index:p,crystal_index:r}=c;return{...c,...{getLotteryIndex(){if(e[n]===r.value){p.value=0,r.value=ee(i[0],i[1]);return}const E=[];for(const[T,$]of Object.entries(s))for(let x=0;x<$;x++)E.push(Number(T));const l=Ne(E),a=ee(0,E.length-1),u=l[a];p.value=J[o].findIndex(T=>T.id===u)}}}}const Nt=o=>{const e=Le(),s=Ee(),n=B(),i=Ie(),{hero_supply_status:c,skin_supply_status:p}=re(n),{resetHeroLuck:r,resetSkinLuck:d,saveGameData:E}=s,{gift_index:l,getLotteryIndex:a}=yt(o),u=J[o],T=o==="HERO"?r:d,$=o==="HERO"?c:p,x=o==="HERO"?"KING_CRYSTAL":"HONOR_CRYSTAL",F=o==="HERO"?"HERO_LOTTERY_STONE":"SKIN_LOTTERY_STONE",Y=o==="HERO"?"HERO_LOTTERY_COIN":"SKIN_LOTTERY_COIN";let N=!1;const C={gift_index:l,last_reward_position:M(0)},{last_reward_position:R}=C,H=f(()=>i.user_data.doubleGoldCardExpireTime!==0),D=f(()=>i.user_data.doubleExpCardExpireTime!==0),Z={have_alone_free:f(()=>{const _=e.articles;return(o==="HERO"?_.HERO_LOTTERY_COIN:_.SKIN_LOTTERY_COIN)>=1}),have_multiple_free:f(()=>{const _=e.articles;return(o==="HERO"?_.HERO_LOTTERY_COIN:_.SKIN_LOTTERY_COIN)>=5}),have_alone_discount:f(()=>{const _=e.articles;return(o==="HERO"?_.HERO_LOTTERY_STONE:_.SKIN_LOTTERY_STONE)>0}),have_multiple_discount:f(()=>{const _=e.articles;return(o==="HERO"?_.HERO_LOTTERY_STONE:_.SKIN_LOTTERY_STONE)>=5})},{have_alone_free:ye,have_multiple_free:Oe,have_alone_discount:Te,have_multiple_discount:ve}=Z;return{...C,...Z,...{getLotteryIndex:a,checkAloneNotCount(){return N?!0:!ye.value&&!Te.value?(q({text:W.yb85,confirm(){if($.value==="IDLE"){n.setTimeMode(o,0),n.startCountdown(o);return}$.value==="RUNNING"&&Ce(He.yz00,"warning")}}),!0):(N=!0,!1)},checkMultipleNotCount(_,y){return N?!0:(a(),!ve.value&&_==="DEDUCTION"?(q({text:W.qv90,confirm(){setTimeout(()=>{y()},1250)}}),!0):!Oe.value&&_==="FREE"?(q({text:W.wr91,confirm(){setTimeout(()=>{y()},1250)}}),!0):(N=!0,!1))},setLastPosition(_){R.value=_},calcAloneReward(){N=!1,e.articles[Y]>0?e.setGamePropNum(Y,1,"SUB"):e.setGamePropNum(F,1,"SUB");let _=u[l.value].num;const y=u[l.value].type;y===x&&T(),y==="GOLD"&&H.value&&(_*=2),["HERO_EXP_ONE","HERO_EXP_TWO"].includes(y)&&D.value&&(_*=2),ne({name:V[y],num:_,icon:w(U[y])}),E()},calcMultipleReward(_){N=!1,e.articles[Y]>0?e.setGamePropNum(Y,5,"SUB"):e.setGamePropNum(F,5,"SUB");const y={};_.forEach(X=>{const v=u[X].type,K=u[X].num;y[v]??(y[v]=0),y[v]+=K||1});const le=[];for(const X in y){const v=X;let K=y[v];v==="GOLD"&&H.value&&(K*=2),["HERO_EXP_ONE","HERO_EXP_TWO"].includes(v)&&D.value&&(K*=2),le.push({num:K,name:V[v],key:v,icon:w(U[v])})}ne(le),E()}}}};export{ht as L,St as S,Nt as u};
